/* Imports pour react-grid-layout */
@import 'react-grid-layout/css/styles.css';
@import 'react-resizable/css/styles.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: dark;
  --desktop-scale: 0.7;
}

html {
  font-size: 15px; /* légèrement augmenté pour les typos */
  overscroll-behavior-y: contain;
}

@media (min-width: 640px) {
  html {
    font-size: 16px;
  }
}
 
/* Desktop compact layout scaling */
.desktop-compact-layout {
  font-size: calc(1rem * 0.7);
}

.desktop-compact-layout h1 {
  font-size: calc(2rem * 0.7);
}

.desktop-compact-layout h2 {
  font-size: calc(1.5rem * 0.7);
}

.desktop-compact-layout h3 {
  font-size: calc(1.25rem * 0.7);
}

.desktop-compact-layout h4 {
  font-size: calc(1.1rem * 0.7);
}

.desktop-compact-layout .text-xs {
  font-size: calc(0.75rem * 0.7); 
}

.desktop-compact-layout .text-sm {
  font-size: calc(0.875rem * 0.7);
}

.desktop-compact-layout .text-base {
  font-size: calc(1rem * 0.7);
}

.desktop-compact-layout .text-lg {
  font-size: calc(1.125rem * 0.7);
}

.desktop-compact-layout .text-xl {
  font-size: calc(1.25rem * 0.7);
}

.desktop-compact-layout .text-2xl {
  font-size: calc(1.5rem * 0.7);
}

.desktop-compact-layout .text-3xl {
  font-size: calc(1.875rem * 0.7);
}

body {
  @apply bg-gray-900 text-gray-100;
  -webkit-tap-highlight-color: transparent;
  overscroll-behavior: none;
  touch-action: manipulation;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
  margin: 0;
  padding: 0;
  width: 100vw;
  overflow-x: hidden !important;
}

/* Background spécifique pour la page de login */
.login-page {
  min-height: 100vh;
  width: 100vw;
  margin: 0;
  padding: 0;
  position: relative;
  overflow-x: hidden;
}

/* Background spécifique pour la page de sélection des personnages */
.character-selection-page {
  min-height: 100vh;
  width: 100vw;
  margin: 0;
  padding: 0;
  position: relative;
  overflow-x: hidden;
}

/* Background par défaut pour l'interface principale */
body:not(.login-page):not(.character-selection-page) {
  background-image: url("https://images.unsplash.com/photo-1553356084-58ef4a67b2a7?q=80&w=1974&auto=format&fit=crop");
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

/* Tooltip animations */
.group {
  position: relative;
}
.tooltip-visible {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: fixed !important;
  left: 50% !important;
  top: 50% !important;
  transform: translate(-50%, -50%) !important;
  z-index: 9999 !important;
  width: min(90vw, 24rem) !important;
  padding: 1.25rem !important;
  background-color: rgb(17, 24, 39) !important;
  border: 1px solid rgb(75, 85, 99) !important;
  border-radius: 0.75rem !important;
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1),
              0 4px 6px -1px rgba(0, 0, 0, 0.1),
              0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
  animation: tooltip-appear 0.2s cubic-bezier(0.16, 1, 0.3, 1) !important;
}

.tooltip-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9998;
  backdrop-filter: blur(2px);
}

@keyframes tooltip-appear {
  from {
    opacity: 0;
    transform: translate(-50%, -45%) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1); 
  }
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(17, 24, 39, 0.95);
  z-index: -1;
}

/* Background fixe qui couvre tout l'écran */
.login-page::after,
.character-selection-page::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-image: url("https://pub-34f7ade8969e4687945b58e1d1b80dd8.r2.dev/static/tmpoofee5sh.png");
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  background-attachment: scroll;
  z-index: -1;
}

/* Pas d'overlay pour la page de login et sélection des personnages */
.login-page::before,
.character-selection-page::before {
  display: none;
}

.stat-card {
  @apply bg-gray-800/30 backdrop-blur-sm border border-gray-700/50 rounded-xl shadow-lg overflow-hidden;
  background-image: linear-gradient(to bottom right, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0));
  -webkit-backdrop-filter: blur(8px);
}

/* ========================================
   Frame Card - Cadre unifié pour tous les panneaux 
   ======================================== */

/* --- Propriétés communes (base) --- */
.frame-card,
.frame-card--light {
  position: relative;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: none;
  border-radius: 0;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.45);
  overflow: visible;
  padding-top: 6px;                     /* empêche le contenu de chevaucher le cadre haut */
  padding-bottom: 6px;                 /* empêche le contenu de chevaucher le cadre bas */
}

/* Cadre décoratif superposé via ::after */
.frame-card::after,
.frame-card--light::after {
  content: '';
  position: absolute;
  top: -64px;
  bottom: -72px;
  left: -57px;
  right: -57px;
  border-image-source: url('https://pub-34f7ade8969e4687945b58e1d1b80dd8.r2.dev/static/backgroundAmbre/AmbreFrame.png');
  border-image-slice: 45%;
  border-image-width: 150px;
  border-image-repeat: stretch;
  border-style: solid;
  border-width: 12px;
  pointer-events: none;
  z-index: 10;
}

.frame-card {
  background-color: rgba(31, 41, 55, 0.70);
}

.frame-card--light {
  background-color: rgba(31, 41, 55, 0.40);
} 

/* --- Pseudo-élément texture (partagé) --- */
.frame-card::before,
.frame-card--light::before {
  content: '';
  position: absolute;
  inset: 0;
  background-size: cover;
  background-repeat: no-repeat;
  opacity: 0.70;
  border-radius: inherit;
  pointer-events: none;
  z-index: 0;
}

/* Pour les modales plein écran, texture répétée sans bandes */
.fixed.inset-0 .frame-card--light::before,
.max-w-4xl .frame-card--light::before {
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
}

/* --- Contenu au-dessus de la texture --- */
.frame-card > *,
.frame-card--light > * {
  position: relative;
  z-index: 1;
}

/* Variante sans le cadre PNG décoratif (garde fond + liseré doré) */
.frame-card--no-frame::after {
  display: none !important;
}

/* ========================================
   Desktop: conteneurs intérieurs transparents
   pour laisser voir la texture du frame-card parent
   ======================================== */

/* ========================================
   Typographie D&D - Cinzel dans les frame-card
   ======================================== */

/* Titres de section : Cinzel semi-bold, teinte parchemin */
.frame-card h2,
.frame-card h3,
.frame-card--light h2,
.frame-card--light h3 {
  font-family: 'Cinzel', serif;
  font-weight: 600;
  color: #EFE6D8;
  letter-spacing: 0.02em;
}

/* Sous-titres : Cinzel regular, parchemin plus foncé */
.frame-card h4,
.frame-card--light h4 {
  font-family: 'Cinzel', serif;
  font-weight: 400;
  color: #D4C4A8;
  letter-spacing: 0.01em;
}

/* Labels de section (span.font-semibold utilisés comme titres) */
.frame-card span.font-semibold,
.frame-card--light span.font-semibold {
  font-family: 'Cinzel', serif;
  font-weight: 600;
  color: #EFE6D8;
}

/* Stat-header : titres dans les en-têtes de cartes intérieures */
.frame-card .stat-header h3,
.frame-card--light .stat-header h3 {
  font-family: 'Cinzel', serif;
  font-weight: 600;
  color: #EFE6D8;
}

/* Boutons principaux dans les frame-card */
.frame-card .btn-primary,
.frame-card--light .btn-primary {
  font-family: 'Cinzel', serif;
  font-weight: 600;
  letter-spacing: 0.03em;
}

/* Labels des onglets (TabNavigation dans TabbedPanel) */
.frame-card button[role="tab"],
.frame-card--light button[role="tab"] {
  font-family: 'Cinzel', serif;
  font-weight: 400;
  letter-spacing: 0.02em;
}

/* Texte courant reste en Inter, couleur ivoire chaud */
.frame-card p,
.frame-card li,
.frame-card span:not(.font-semibold),
.frame-card--light p,
.frame-card--light li,
.frame-card--light span:not(.font-semibold) {
  font-family: 'Inter', system-ui, sans-serif;
  color: #E8DFD2;
}

/* Couleur ivoire globale dans les frame-card */
.frame-card,
.frame-card--light {
  color: #E8DFD2;
}

.frame-card .text-white,
.frame-card--light .text-white {
  color: #EFE6D8 !important;
}

.frame-card .text-gray-100,
.frame-card--light .text-gray-100 {
  color: #EFE6D8 !important;
}

.frame-card .text-gray-200,
.frame-card--light .text-gray-200 {
  color: #E8DFD2 !important;
}

.frame-card .text-gray-300,
.frame-card--light .text-gray-300 {
  color: #D4C4A8 !important;
}

.frame-card .text-gray-400,
.frame-card--light .text-gray-400 {
  color: #B8A88A !important;
}

.frame-card .text-gray-500,
.frame-card--light .text-gray-500 {
  color: #9A8B6E !important;
}

/* Valeurs numériques (scores, bonus, HP) : rester en sans-serif pour lisibilité */
.frame-card input,
.frame-card select,
.frame-card--light input,
.frame-card--light select {
  font-family: 'Inter', system-ui, sans-serif;
}

/* Rendre les stat-card / stats-card transparents à l'intérieur des frame-card */
.frame-card .stat-card,
.frame-card .stats-card,
.frame-card--light .stat-card,
.frame-card--light .stats-card {
  background-color: transparent;
  background-image: none;
  border-color: transparent;
  box-shadow: none;
  -webkit-backdrop-filter: none;
  backdrop-filter: none;
}

/* Rendre les stat-header transparents */
.frame-card .stat-header,
.frame-card--light .stat-header {
  background: transparent;
  border-bottom-color: rgba(212, 170, 96, 0.15);   /* filet doré très subtil */
}

/* Sous-conteneurs avec fond gris inline (Tailwind) */
.frame-card [class*="bg-gray-800"],
.frame-card--light [class*="bg-gray-800"] {
  background-color: transparent !important;
}

/* Bordures internes grises → transparentes */
.frame-card [class*="border-gray-700"],
.frame-card--light [class*="border-gray-700"] {
  border-color: rgba(212, 170, 96, 0.12) !important;
}

/* Sous-cartes arrondies (bg-gray-800/50, bg-gray-800/30, etc.) */
.frame-card .bg-gray-800\/50,
.frame-card .bg-gray-800\/30,
.frame-card .bg-gAmbreray-800\/40,
.frame-card--light .bg-gray-800\/50,
.frame-card--light .bg-gray-800\/30,
.frame-card--light .bg-gray-800\/40 {
  background-color: rgba(0, 0, 0, 0.15) !important;
  border-color: rgba(212, 170, 96, 0.10) !important;
}

/* --- Texture par défaut (BGambre1) --- */
.frame-card::before,
.frame-card--light::before {
  background-image: url('https://pub-34f7ade8969e4687945b58e1d1b80dd8.r2.dev/static/backgroundAmbre/BGambre1.webp');
  background-position: center center;
}

/* --- Variantes de texture (panachage) --- */
.frame-card--tex2::before {
  background-image: url('https://pub-34f7ade8969e4687945b58e1d1b80dd8.r2.dev/static/backgroundAmbre/BGAmbre2.webp') !important;
  background-position: top left !important;
}

.frame-card--tex3::before {
  background-image: url('https://pub-34f7ade8969e4687945b58e1d1b80dd8.r2.dev/static/backgroundAmbre/BGAmbre3.webp') !important;
  background-position: bottom right !important;
}

.frame-card--tex4::before {
  background-image: url('https://pub-34f7ade8969e4687945b58e1d1b80dd8.r2.dev/static/backgroundAmbre/BGambre4.webp') !important;
  background-position: center top !important;
}

/* Le contenu doit passer au-dessus du pseudo-élément */
.frame-card > * {
  position: relative;
  z-index: 1;
}

/* Variante plus transparente (ex: zone HP) */
.frame-card--light {
  position: relative;
  background-color: rgba(31, 41, 55, 0.40);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border-radius: 7px;
  border: 1px solid rgba(212, 170, 96, 0.35);
  box-shadow:
    inset 0 1px 0 rgba(255, 235, 180, 0.12),
    0 6px 18px rgba(0, 0, 0, 0.45);
  overflow: hidden;
}

.frame-card--light::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image: url('https://pub-34f7ade8969e4687945b58e1d1b80dd8.r2.dev/static/backgroundAmbre/BGambre4.webp');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.50;
  border-radius: inherit;
  pointer-events: none;
  z-index: 0;
}

.frame-card--light > * {
  position: relative;
  z-index: 1;
}

.stat-header {
  @apply bg-gradient-to-r from-gray-800/50 to-gray-900/50 border-b border-gray-700/50 p-4;
}

.input-dark {
  @apply bg-gray-800 border-gray-700 text-gray-100 focus:ring-red-500 focus:border-red-500;
  -webkit-appearance: none;
  appearance: none;
}

/* Optimisations tactiles */
button, 
[role="button"],
input,
select {
  @apply min-h-[27px] min-w-[27px]; /* taille minimale des boutons réduite à 27px */
  touch-action: manipulation;
}

.btn-primary {
  @apply bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white transition-all duration-200 shadow-lg shadow-red-900/20 hover:shadow-red-900/40;
}

/* ========================================
   Boutons vitreux dans les frame-card
   Transparents, désaturés, cohérents avec le thème
   ======================================== */

/* Boutons par défaut dans les frame-card : vitreux, pas de couleur forte */
.frame-card button,
.frame-card--light button {
  --btn-glass-bg: rgba(255, 255, 255, 0.06);
  --btn-glass-border: rgba(255, 255, 255, 0.10);
  --btn-glass-hover-bg: rgba(255, 255, 255, 0.12);
  --btn-glass-hover-border: rgba(255, 255, 255, 0.18);
}

.btn-transparent-cinzel {
  background: rgba(255,255,255,0.05);
  color: #EFE6D8;
  font-family: 'Cinzel', serif;
  font-weight: 600;
  letter-spacing: 0.02em;
  transition: background 0.2s;
  box-shadow: none !important;
}

.btn-transparent-cinzel:hover {
  background: rgba(255,255,255,0.12);
  color: #FFF8E7;
}

/* Boutons d'action "accent" (ex: Ajouter des sorts) */
.btn-amber--accent {
  background: rgba(255, 255, 255, 0.08) !important;
  border: 1px solid rgba(212, 170, 96, 0.25) !important;
  color: #D4C4A8 !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  transition: all 0.2s ease;
}

.btn-amber--accent:hover {
  background: rgba(255, 255, 255, 0.14) !important;
  border-color: rgba(212, 170, 96, 0.40) !important;
  color: #EFE6D8 !important;
}

.btn-secondary {
  @apply bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-800 hover:to-gray-900 text-gray-100 transition-all duration-200 shadow-lg shadow-gray-900/20 hover:shadow-gray-900/40;
}

.spell-slot {
  @apply bg-transparent border border-[#B87333]/20 rounded-lg p-3;
}

/* Boutons de sorts uniformisés */
.spell-slot button {
  @apply bg-transparent hover:bg-[#B87333]/10 text-white relative overflow-hidden;
  animation: button-pulse 3s infinite;
  box-shadow: 0 0 0 2px rgba(184, 115, 51, 0.3);
  min-width: 27px;
  min-height: 27px;
  width: 33px;
  height: 33px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem; 
  border: 1px solid rgba(184, 115, 51, 0.2);
}
/* Correction : la case de préparation des sorts n’est plus grisée */
.spell-slot input[type="checkbox"].prepare-spell {
  @apply bg-gray-900/50 hover:bg-gray-800/50 text-white;
  appearance: none;  
  width: 20px;
  height: 20px;
  border-radius: 0.25rem;
  border: 2px solid rgba(147, 51, 234, 0.5);
  cursor: pointer;
  display: inline-block;
  position: relative;
}

.spell-slot input[type="checkbox"].prepare-spell:checked::after {
  content: '';
  position: absolute;
  top: 2px;
  left: 6px;
  width: 6px;
  height: 12px;
  border: solid white;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* Indicateur de sélection pour les cartes de sorts */
.spell-card-selected {
  border: 2px solid #B87333 !important;
  box-shadow: 0 0 0 3px rgba(184, 115, 51, 0.2),
              0 0 12px rgba(184, 115, 51, 0.4) !important;
}

/* Cartes de sorts transparentes dans les frame-card */
.frame-card .spell-card,
.frame-card--light .spell-card {
  background-color: transparent !important;
  background-image: none !important;
  border-color: rgba(184, 115, 51, 0.15) !important;
}

/* En-têtes de niveau de sort */
.frame-card .spell-level-header,
.frame-card--light .spell-level-header {
  background: transparent !important;
  border-bottom: 1px solid rgba(184, 115, 51, 0.2) !important;
  font-family: 'Cinzel', serif;
  font-weight: 600;
  color: #EFE6D8;
}

/* Sections de sorts repliables */
.frame-card .spell-section-expanded,
.frame-card--light .spell-section-expanded {
  background-color: rgba(0, 0, 0, 0.1) !important;
  border: 1px solid rgba(184, 115, 51, 0.12) !important;
}

 /* ========================================
   Background pour le créateur de personnage
   ======================================== */
.bg-fantasy {
  background-image: url('/fondecran/Table.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

/* Overlay optionnel pour améliorer la lisibilité du texte */
.wizard-container::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.35); /* Noir semi-transparent pour améliorer la lisibilité */
  pointer-events: none;
  z-index: 0;
}

.wizard-container > * {
  position: relative;
  z-index: 1;
}

/* ========================================
   Ajustements pour l'onglet Classe en mode desktop
   ======================================== */
.desktop-classes-tab .text-base {
  font-size: 0.875rem; /* 14px au lieu de 16px */
}

.desktop-classes-tab .text-sm {
  font-size: 0.8125rem; /* 13px au lieu de 14px */
}

.desktop-classes-tab .text-xs {
  font-size: 0.75rem; /* 12px - inchangé */
}

/* Réduire les titres des cartes de compétences */
.desktop-classes-tab h4 {
  font-size: 0.9375rem; /* 15px au lieu de 18px */
}

/* Réduire le texte dans les descriptions */
.desktop-classes-tab p {
  font-size: 0.875rem; /* 14px au lieu de 16px */
  line-height: 1.5;
}

/* Réduire les labels/étiquettes */
.desktop-classes-tab label {
  font-size: 0.8125rem; /* 13px */
}

/* Réduire les boutons */
.desktop-classes-tab button {
  font-size: 0.875rem; /* 14px */
}

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.animate-fade-in {
  animation: fade-in 0.2s ease-out;
}

.animate-scale-in {
  animation: scale-in 0.3s ease-out;
} 

/* Cartes transparentes pour le modal de paramètres avec fond parchemin */
.parchment-modal .stat-card {
  background: transparent !important;
  border: 1px solid rgba(139, 92, 46, 0.3) !important;
  box-shadow: none !important;
}

.parchment-modal .stat-header {
  background: rgba(0, 0, 0, 0.15) !important;
  border-bottom: 1px solid rgba(139, 92, 46, 0.2) !important;
}

.parchment-modal .input-dark,
.parchment-modal select,
.parchment-modal textarea {
  background: rgba(0, 0, 0, 0.2) !important;
  border-color: rgba(139, 92, 46, 0.3) !important;
}

.parchment-modal .input-dark:focus,
.parchment-modal select:focus,
.parchment-modal textarea:focus {
  background: rgba(0, 0, 0, 0.3) !important;
  border-color: rgba(139, 92, 46, 0.5) !important;
}
/* Animation glow pour le bouton MJ */
@keyframes glow-pulse {
  0%, 100% {
    box-shadow: 
      0 0 30px rgba(212, 170, 96, 0.6),
      0 0 60px rgba(212, 170, 96, 0.4),
      0 0 100px rgba(212, 170, 96, 0.2),
      inset 0 1px 2px rgba(255, 255, 255, 0.15);
  }
  50% {
    box-shadow: 
      0 0 40px rgba(212, 170, 96, 0.8),
      0 0 80px rgba(212, 170, 96, 0.5),
      0 0 120px rgba(212, 170, 96, 0.3),
      inset 0 1px 2px rgba(255, 255, 255, 0.15);
  }
}

.animate-glow {
  animation: glow-pulse 3s ease-in-out infinite;
}

/* Indicateur d'onglet actif - trait subtil avec glow INTENSE */
.tab-indicator-active {
  position: relative;
  border-bottom: 2px solid rgba(212, 170, 96, 0.6);
  background: transparent !important;
  box-shadow: none !important;
}

.tab-indicator-active::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, 
    transparent 0%, 
    rgba(255, 223, 140, 0.4) 20%, 
    rgba(255, 235, 180, 0.6) 50%, 
    rgba(255, 223, 140, 0.4) 80%, 
    transparent 100%
  );
  box-shadow: 
    0 0 15px rgba(255, 223, 140, 1),
    0 0 30px rgba(212, 170, 96, 0.8),
    0 0 45px rgba(212, 170, 96, 0.6),
    0 2px 60px rgba(255, 223, 140, 0.5);
  animation: tab-glow-intense 1.5s ease-in-out infinite;
  pointer-events: none;
  will-change: box-shadow;
}

@keyframes tab-glow-intense {
  0%, 100% {
    opacity: 0.7;
    box-shadow: 
      0 0 15px rgba(255, 223, 140, 1),
      0 0 30px rgba(212, 170, 96, 0.8),
      0 0 45px rgba(212, 170, 96, 0.6);
  }
  50% {
    opacity: 1;
    box-shadow: 
      0 0 25px rgba(255, 235, 180, 1),
      0 0 50px rgba(255, 223, 140, 0.9),
      0 0 75px rgba(212, 170, 96, 0.7),
      0 2px 100px rgba(255, 223, 140, 0.6);
  }
}